#!/bin/bash
# Installation:
#  Copy to /etc/bash_completion.d/n98-magerun
# or
#  Append to ~/.bash_completion
#

_n98-magerun()
{
    local cur opts cmd commandlist
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    cmd="${COMP_WORDS[0]}"

    _get_comp_words_by_ref -n : cur
    
    commandlist=$("$cmd" --raw --no-ansi list < /dev/null)
    opts=$(echo "$commandlist" | sed "s/\s.*//g" | paste -sd " ")

    COMPREPLY=( $(compgen -W "${opts}" -- "${cur}") )
    __ltrim_colon_completions "$cur"
    return 0
}


complete -F _n98-magerun n98-magerun.phar
complete -F _n98-magerun n98-magerun
complete -F _n98-magerun magerun
